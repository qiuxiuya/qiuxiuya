name: Rule backup
on:
  schedule:
    - cron: '0 0 * * *'
  workflow_dispatch:

jobs:
  update-rules:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout rules branch
        uses: actions/checkout@v4
        with:
          ref: rules

      - name: Download
        run: |
          mkdir -p singbox mihomo
          curl -L https://raw.githubusercontent.com/Cats-Team/AdRules/main/adrules-singbox.srs -o singbox/ad.srs
          curl -L https://raw.githubusercontent.com/Cats-Team/AdRules/main/adrules-mihomo.mrs -o mihomo/ad.mrs

      - name: push
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "41898282+github-actions[bot]@users.noreply.github.com"

          git add singbox/ad.srs mihomo/ad.mrs
          git commit --allow-empty -m " "
          git push origin rules
