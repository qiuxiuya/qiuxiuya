mixed-port: 2080
ipv6: true
allow-lan: true
unified-delay: false
tcp-concurrent: true
external-controller: 127.0.0.1:9090
external-ui: ./dashboard/
external-ui-url: "https://github.com/Zephyruso/zashboard/releases/latest/download/dist.zip"
log-level: info

sniffer:
  enable: true
  force-dns-mapping: true
  parse-pure-ip: true
  override-destination: false
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]

geodata-mode: false
geox-url:
  geoip: "https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geoip.db"
  geosite: "https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geosite.dat"

profile:
  store-selected: true
  store-fake-ip: true

tun:
  enable: true
  stack: mixed
  dns-hijack: [any:53]
  auto-detect-interface: true
  auto-route: true
  device: tun0

dns:
  enable: true
  prefer-h3: true
  ipv6: true
  enhanced-mode: fake-ip
  listen: :1053
  fake-ip-range: 198.18.0.0/15
  fake-ip-range6: fdfe:dcba:9876::1/64
  fake-ip-ttl: 1
  fake-ip-filter:
    - "*"
    - "+.lan"
    - "+.local"
    - "+.market.xiaomi.com"
    - "+.direct"
    - "+.msftconnecttest.com"
    - "+.msftncsi.com"
  nameserver:
    - "quic://223.5.5.5"

proxy-groups:
  - name: "Proxy"
    type: select
    url: "https://www.gstatic.com/generate_204"
    include-all: true

rule-providers:
  AD:
    type: http
    behavior: domain
    format: mrs
    path: ./AD.mrs
    url: "https://raw.githubusercontent.com/217heidai/adblockfilters/main/rules/adblockmihomo.mrs"

rules:
  - RULE-SET,AD,REJECT
  - GEOSITE,google,Proxy
  - GEOSITE,CN,DIRECT
  - GEOIP,private,DIRECT
  - GEOIP,CN,DIRECT
  - MATCH,Proxy